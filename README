ORMtnMan's Real Guns Mod for Project Zomboid

Original mod by ORMtnMan, Rechambered version by Fenris_Wolf

This is the development repository, and files maybe different then the stable version listed in theindiestone
forum thread.  You may run into issues trying to connect to servers that expect players to have the stable
version, and servers should not run this version as it is constantly changing and may have bugs.

To get the latest stable version, visit theindiestone forums: 
https://theindiestone.com/forums/index.php?/topic/23237-orgm-rechambered/

or use this direct download link:
https://downloads.tekagis.ca/ProjectZomboidMods/ORGM.zip

---------------------------------------------------------------------------------------
version 2.00 Stable

Changes of Note:

* Complete code rewrite and cleanup.

* Many corrections and bug fixes.

* Weapon and ammo spawn rates reduced, and now obey sandbox weapon loot rarity settings.

* Distant gunshot sounds now properly play in MP again.

* Added FMJ and HP versions of each round, with different stats

* Conversion of guns to full-auto/semi-auto, pump/semi, and ammo conversions are no longer required.
    Previously every gun had its own variation, on conversion the old gun was removed and replaced with
    the new variant.

* Guns can now be loaded with multiple ammo types at the same time. A 5.56 rifle can now have 5.56 FMJ,
    5.56 HP, .223 FMJ and .223 HP all in the same magazine. This applies to other guns as well 
    (ie: mixing buck and slugs in shotguns)

* Bullet penetration is no longer a simple true/false dependent on the gun item. Its now based on a % 
    chance, dependent on the bullet type (HP rounds have low chance of penetration while FMJ is higher),
    rechecked every round fired. Ideally this should check on every hit (ie: passing through multiple
    zombies) but its better then nothing.

* Gun damage is now dependent on the bullet type loaded. FMJ have a lower min damage, while HP is higher.

* The tooltip on inventory items now specifies what ammo type is currently loaded in a gun or magazine,
    and what fire mode (Full/Semi) a gun is currently using.

* Shotguns with buckshot loads now have a chance of missing.

* Increased durability of all firearms, especially revolvers.

* Guns now have a chance of jamming based on weapon condition. Racking the gun clears the jam. Revolvers
    and break barrels are not susceptible to jamming. Easy and Normal difficulty will auto rack to clear.
    At any rate, the jammed round will fall to the floor. This is affected by the lucky/unlucky traits.

* When reloading a revolver, if there are empty shells in the cylinder the entire cylinder contents are
    dumped out and all cylinder spots must be reloaded. You can not just replace the empty shells.

* Unloading bullets from magazines places rounds in inventory. Unloading from a gun drops rounds on the 
    ground (from racking the slide, or dumping out the cylinder)
    
* Guns now litter the ground with empty shells when firing. These can be collected, boxed or put in canisters
    like normal rounds.
    
* Context menu has been added to set a preferred ammo type on guns and magazines.
    (ie: load only 5.56 FMJ). This can be set to "Any" (loads any available ammo),
    any bullet type the gun is capable of using, or "Mixed Load" to specifically 
    mix ammo in the magazine.

* Context menu has been added for manually cocking/releasing the hammer, or opening/closing the slide/bolt.

* Context menu has been added for spinning the cylinder on rotary guns (ie: revolvers)

* Context menu has been added for shooting yourself in the head, curing infection so your corpse doesn't 
    come back as a zombie.  Note if done with a partially loaded revolver (russian roulette) it cures 
    boredom as well.
    
* Code is now called when pulling the trigger on a gun that won't fire (unloaded etc). This will properly
    drop the hammer, or in the case of doubleaction revolvers: cock, rotate and release.

* Speed Loaders and Stripper Clips have been separated from magazines and act independently, a gun can used
    both.

* Clients on 'Easy Reloading' settings are effectively set to 'Normal'. This is a REAL GUNS MOD. Real guns
    have magazines.


---------------------------------------------------------------------------------------
Changes for modders and editors:

* All lua files have been rewritten and documented for maintainability. Much redundant repetitive code and 
    tables have been removed.

* Ammo has been renamed, using a new naming scheme: Ammo_<caliber>_<bullet_type>

* Ammo now has dummy generic rounds for each type. These dummy rounds are named simply Ammo_<caliber> without a 
    bullet type (ie: Ammo_223Remington is the dummy round, Ammo_223Remington_FMJ and Ammo_223Remington_HP are real 
    rounds). These dummy rounds should never be spawned or accessible to players. They do not have boxes or cans.
    However, when adding magazines or firearms, these dummy rounds should be used as the AmmoType instead of the 
    real rounds.

* Weapon damage and other attributes are now determined by the current round in the chamber, instead of the definitions
    in the .txt files. (see ORGMWeaponData.lua, ORGMMasterAmmoTable)

* ORGMDistributions.lua is now actually manageable. There is no longer a need to build guns or ammo tables. Or the
    WeaponsUpgrades table. These are now built automatically on loading the script using data from ORGMWeaponData.lua

* All weapon classes have been merged into a single class: ISORGMWeapon
    Guns are now defined by several properties that dictate how they handle:
    actionType - Auto, Lever, Rotary, Pump, Bolt, Break (barrel)
    triggerType - SingleAction, DoubleAction, DoubleActionOnly

* Overridden functions:
    ISUI/ISToolTipInv:render()
    Reloading/ISReloadManager:checkLoaded()
    Reloading/ISReloadManager:startReloadFromUi()
    
    *Reloading/ISReloadManager has several new functions injected into it.


---------------------------------------------------------------------------------------
Integrating into your mod, creating addons and compatibility patches:

    I've attempted to make compatibility as easy as possible.  All weapon, magazine, ammo
and weapon upgrade information is in the ORGMWeaponData.lua file, in global tables that 
can be accessed from your mod. Tables of note:

    ORGMAlternateAmmoTable 
this table contains a list of 'dummy rounds' keys and actual ammo that should be used in its place. For example: 
["Ammo_556x45mm"]   = {"Ammo_556x45mm_FMJ", "Ammo_556x45mm_HP", "Ammo_223Remington_FMJ", "Ammo_223Remington_HP"}
Shows that any gun/magazine that has its AmmoType as Ammo_556x45mm can fire any of the above rounds.
    

    ORGMMasterAmmoTable
this table contains all real ammo, and its stats. It can be used to get a list of all the ammo in ORGM:
for ammoType, ammoData in pairs(ORGMMasterAmmoTable) do 
    ... 
end


    ORGMMasterMagTable
this table contains all the magazines, and its stats. It can be used to get a list of all the magazines in ORGM:
for magType, magData in pairs(ORGMMasterMagTable) do 
    ... 
end


    ORGMMasterWeaponTable
this table contains all the guns, and its stats. It can be used to get a list of all the guns in ORGM:
for gunType, gunData in pairs(ORGMMasterWeaponTable) do 
    ... 
end


    ORGMRepairKitsTable
this table contains a list of all repair kits available:
for index, repairType in ipairs(ORGMRepairKitsTable) do
    ...
end


    ORGMWeaponModsTable
this table contains a list of all repair kits available:
for index, modType in ipairs(ORGMWeaponModsTable) do
    ...
end


    media/lua/shared/ORGMUtil.lua
this file contains helper functions that can be called from your mod. These functions are subject to change
over time, but the 2 more useful ones are:

ORGMUtil.findBestMagazineInContainer(magazineType, preferredType, containerItem)
and
ORGMUtil.findAmmoInContainer(dummyName, preferredType, containerItem)

These 2 function help when finding ammo using ORGM's alternate ammo system. 
See the documentation comments in ORGMUtil for more information.

